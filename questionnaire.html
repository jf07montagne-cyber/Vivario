<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vivario — Questionnaire</title>

  <link rel="stylesheet" href="style.css?v=1" />

  <style>
    .topbar{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:10px;}
    .qcard{display:grid;gap:10px;margin-top:10px;}
    .opt{display:flex;gap:12px;align-items:flex-start;padding:12px;border-radius:14px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.10);cursor:pointer;user-select:none;}
    .opt input{margin-top:2px;}
    .opt:hover{background:rgba(255,255,255,.09);}
    .hint{font-size:12px;opacity:.78;margin-top:-4px;}
    .err{margin-top:6px;color:#ffd5d5;font-size:13px;}
    .navrow{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;}
    .btnLike{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 14px;border-radius:14px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:inherit;text-decoration:none;cursor:pointer;}
    .btnLike:hover{background:rgba(255,255,255,.10);}
    .btnPrimary{background:rgba(120,160,255,.22);border:1px solid rgba(120,160,255,.35);}
    .btnPrimary:hover{background:rgba(120,160,255,.30);}
    .muted{opacity:.78;}
    .small{font-size:12px;}
    h1,h2{margin:0;}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">

      <div class="topbar">
        <div>
          <h1>Vivario</h1>
          <div class="small muted">Questionnaire v1.1</div>
        </div>
        <div id="qCounter" class="small muted"></div>
      </div>

      <div class="qcard">
        <h2 id="qTitle">Chargement…</h2>

        <!-- engine.js le référence : qText -->
        <div id="qText" class="muted" style="display:none"></div>

        <div id="qSubtitle" class="muted" style="line-height:1.55"></div>
        <div id="qHint" class="hint" style="display:none"></div>

        <div id="options" class="qcard"></div>
        <div id="err" class="err"></div>

        <div class="navrow">
          <button id="btnBack" type="button" class="btnLike">← Retour</button>
          <button id="btnNext" type="button" class="btnLike btnPrimary">Continuer →</button>
          <a class="btnLike" href="accueil.html?v=1">Quitter</a>
        </div>

        <div class="sep" style="margin-top:14px"></div>

        <div class="small muted" style="line-height:1.55">
          <b>Confidentialité :</b> Vivario ne remplace pas un professionnel de santé.<br>
          Si tu es en détresse ou en danger immédiat : 15 / 112, ou contacte un proche.
        </div>
      </div>
    </div>
  </div>

  <!-- ✅ IMPORTANT: sound.js avant engine.js, sans defer (plus fiable) -->
  <script src="sound.js?v=5"></script>
  <script src="engine.js?v=2"></script>

  <!-- ✅ Tap global: tente de démarrer le son au 1er geste utilisateur -->
  <script>
    (function(){
      let done = false;
      async function unlock(){
        if (done) return;
        done = true;
        try { await window.VivarioSound?.ensureStarted?.(); } catch {}
        window.removeEventListener("pointerdown", unlock);
        window.removeEventListener("touchstart", unlock);
      }
      window.addEventListener("pointerdown", unlock, { passive: true });
      window.addEventListener("touchstart", unlock, { passive: true });
    })();
  </script>
</body>
</html>