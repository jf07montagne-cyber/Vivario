<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vivario — Respiration</title>
  <link rel="stylesheet" href="style.css?v=19" />
  <meta name="theme-color" content="#071125" />
</head>

<body class="page-breath">
  <main class="wrap">
    <header class="top">
      <h1 class="brand">Vivario</h1>
      <p class="muted">Respiration guidée — 1 minute pour revenir au calme.</p>
    </header>

    <section class="card breath-card">
      <div class="breath-grid">
        <div class="breath-visual">
          <!-- ✅ WebGL (profondeur + lumière) -->
          <canvas id="glCanvas" aria-hidden="true"></canvas>
          <!-- ✅ Particules 2D (par-dessus) -->
          <canvas id="airCanvas" aria-hidden="true"></canvas>

          <div class="lungs-wrap">
            <svg class="lungs-pro lungs-3d" viewBox="0 0 520 520" role="img" aria-label="Poumons animés">
              <path class="tube-fat" d="M260 72 C260 105 260 122 260 150" />
              <path class="tube" d="M260 72 C260 105 260 122 260 150" />
              <path class="tube-fat" d="M260 150 C235 160 220 170 205 190" />
              <path class="tube" d="M260 150 C235 160 220 170 205 190" />
              <path class="tube-fat" d="M260 150 C285 160 300 170 315 190" />
              <path class="tube" d="M260 150 C285 160 300 170 315 190" />

              <path class="branch" d="M205 190 C182 210 168 230 160 255" />
              <path class="branch" d="M205 190 C188 215 185 235 190 265" />
              <path class="branch" d="M205 190 C196 230 205 250 214 270" />

              <path class="branch" d="M315 190 C338 210 352 230 360 255" />
              <path class="branch" d="M315 190 C332 215 335 235 330 265" />
              <path class="branch" d="M315 190 C324 230 315 250 306 270" />

              <path class="lung-outline" d="M210 190
                C165 200 140 240 138 292
                C136 350 172 410 212 440
                C238 460 248 458 250 430
                C252 400 240 350 236 318
                C232 286 230 240 246 210
                C256 192 240 185 210 190 Z" />
              <path class="lung-outline" d="M310 190
                C355 200 380 240 382 292
                C384 350 348 410 308 440
                C282 460 272 458 270 430
                C268 400 280 350 284 318
                C288 286 290 240 274 210
                C264 192 280 185 310 190 Z" />

              <path class="lung-fill" d="M210 200
                C170 210 150 245 148 292
                C146 342 178 395 215 425
                C236 442 242 438 243 420
                C245 392 235 352 232 320
                C229 288 228 244 242 218
                C250 203 236 196 210 200 Z" />
              <path class="lung-fill" d="M310 200
                C350 210 370 245 372 292
                C374 342 342 395 305 425
                C284 442 278 438 277 420
                C275 392 285 352 288 320
                C291 288 292 244 278 218
                C270 203 284 196 310 200 Z" />

              <path class="air" d="M260 88 C260 110 260 130 260 150
                                C240 158 225 170 205 190
                                C180 220 170 250 165 285" />
              <path class="air" d="M260 88 C260 110 260 130 260 150
                                C280 158 295 170 315 190
                                C340 220 350 250 355 285" />

              <circle class="air-dot air-dot1" cx="260" cy="120" r="4" />
              <circle class="air-dot air-dot2" cx="250" cy="160" r="3.5" />
              <circle class="air-dot air-dot3" cx="270" cy="160" r="3.5" />
            </svg>
          </div>
        </div>

        <div class="breath-side">
          <div class="breath-status">
            <div class="breath-stage" id="stageLabel">Prêt</div>
            <div class="breath-sec" id="secLabel">—</div>
            <div class="breath-coach" id="coachText">
              Inspire par le nez… puis expire lentement.
            </div>

            <!-- ✅ boutons sous les instructions (validé) -->
            <div class="breath-actions">
              <button class="btn primary" id="btnStart" type="button">▶ Démarrer</button>
              <button class="btn ghost" id="btnStop" type="button">⏹ Stop</button>
            </div>
          </div>

          <div class="sep"></div>

          <div class="breath-settings">
            <div class="row">
              <label class="muted" for="rhythmSelect" style="margin:0;">Rythme</label>
              <select id="rhythmSelect">
                <option value="4-0-6">4 • 0 • 6 (calme)</option>
                <option value="4-4-6">4 • 4 • 6 (focus)</option>
                <option value="5-2-7">5 • 2 • 7 (profond)</option>
                <option value="6-2-8">6 • 2 • 8 (relax)</option>
              </select>
            </div>

            <div class="checks" style="display:flex; flex-wrap:wrap;">
              <label><input type="checkbox" id="optVoice" checked> Voix</label>
              <label><input type="checkbox" id="optCount" checked> Décompte</label>
              <label><input type="checkbox" id="optTick" checked> Tick</label>
              <label><input type="checkbox" id="optVibe"> Vibration</label>
              <label><input type="checkbox" id="optSoft" checked> Coach doux</label>
            </div>

            <p class="tiny muted" style="margin:10px 0 0; line-height:1.45;">
              Astuce Android : si la voix ne part pas, touche l’écran une fois puis relance.
            </p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script src="sound.js?v=19"></script>
  <script src="ambiance.js?v=18"></script>
  <script src="ui.js?v=18"></script>
  <script src="respiration.js?v=19"></script>
</body>
</html>